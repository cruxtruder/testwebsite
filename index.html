<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Roblox T-Shirt Generator</title>
    <style>
        /* Loading the custom font from your GitHub repo */
        @font-face {
            font-family: 'SpecialFont';
            src: url('fonts/special-font.ttf'); /* Ensure this path is correct */
        }

        body { font-family: 'Segoe UI', sans-serif; background: #1a1a1a; color: white; display: flex; flex-direction: column; align-items: center; padding: 40px; }
        .editor { display: flex; gap: 40px; background: #2a2a2a; padding: 30px; border-radius: 15px; border: 1px solid #444; }
        
        .controls { width: 300px; display: flex; flex-direction: column; gap: 20px; }
        canvas { 
            background-image: linear-gradient(45deg, #333 25%, transparent 25%), 
                              linear-gradient(-45deg, #333 25%, transparent 25%), 
                              linear-gradient(45deg, transparent 75%, #333 75%), 
                              linear-gradient(-45deg, transparent 75%, #333 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            border: 2px solid #000;
            image-rendering: pixelated; /* Keeps it sharp */
            width: 256px; height: 256px; /* Visual zoom, actual pixels remain 128 */
        }

        input[type="text"] { padding: 10px; border-radius: 5px; border: none; font-size: 16px; }
        .ribbon-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .ribbon-btn { cursor: pointer; border: 2px solid transparent; border-radius: 5px; background: #333; transition: 0.2s; }
        .ribbon-btn.active { border-color: #00ff00; background: #444; }
        .ribbon-btn img { width: 100%; display: block; }
        
        .download-btn { background: #00ff00; color: black; font-weight: bold; padding: 15px; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

    <h2>T-Shirt Label Generator</h2>

    <div class="editor">
        <div class="controls">
            <label>Name (Max 8 Characters)</label>
            <input type="text" id="userName" maxlength="8" placeholder="Enter Name" oninput="updateCanvas()">

            <label>Select Ribbon</label>
            <div class="ribbon-grid" id="ribbonGrid">
                <div class="ribbon-btn" onclick="selectRibbon('ribbon1.png', this)"><img src="ribbons/ribbon1.png"></div>
                <div class="ribbon-btn" onclick="selectRibbon('ribbon2.png', this)"><img src="ribbons/ribbon2.png"></div>
                <div class="ribbon-btn" onclick="selectRibbon('ribbon3.png', this)"><img src="ribbons/ribbon3.png"></div>
            </div>

            <button class="download-btn" onclick="download()">Download 128x128 PNG</button>
        </div>

        <div class="preview">
            <canvas id="tshirtCanvas" width="128" height="128"></canvas>
            <p style="text-align:center; color: #888;">Preview (2x Zoom)</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('tshirtCanvas');
        const ctx = canvas.getContext('2d');
        let selectedRibbonPath = null;

        // Configuration for "Set Places"
        const POSITIONS = {
            ribbon: { x: 14, y: 10, w: 100, h: 100 }, // Centralized
            text: { x: 64, y: 115 } // Bottom center
        };

        function selectRibbon(path, el) {
            // Highlight selection
            document.querySelectorAll('.ribbon-btn').forEach(btn => btn.classList.remove('active'));
            el.classList.add('active');
            
            selectedRibbonPath = 'ribbons/' + path;
            updateCanvas();
        }

        async function updateCanvas() {
            // 1. Start with transparent canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 2. Draw Ribbon if selected
            if (selectedRibbonPath) {
                const img = await loadImage(selectedRibbonPath);
                ctx.drawImage(img, POSITIONS.ribbon.x, POSITIONS.ribbon.y, POSITIONS.ribbon.w, POSITIONS.ribbon.h);
            }

            // 3. Draw Text
            const name = document.getElementById('userName').value;
            ctx.font = "20px 'SpecialFont'"; // Use your custom font name
            ctx.fillStyle = "white";
            ctx.textAlign = "center";
            ctx.shadowColor = "black";
            ctx.shadowBlur = 4;
            ctx.fillText(name, POSITIONS.text.x, POSITIONS.text.y);
        }

        function loadImage(src) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.src = src;
            });
        }

        function download() {
            const link = document.createElement('a');
            link.download = 'tshirt-export.png';
            link.href = canvas.toDataURL("image/png");
            link.click();
        }

        // Wait for fonts to load before first draw
        document.fonts.ready.then(() => updateCanvas());
    </script>
</body>
</html>
